function getRandomNum(e,t){return Math.random()*(t-e)+e}function onObjectSelected(e){var t=e.target;$("#text-string").val(""),t.hasRotatingPoint=!0,t&&"text"===t.type?($("#texteditor").css("display","block"),$("#text-string").val(t.getText()),$("#text-fontcolor").miniColors("value",t.fill),$("#text-strokecolor").miniColors("value",t.strokeStyle),$("#imageeditor").css("display","block")):t&&"image"===t.type&&($("#texteditor").css("display","none"),$("#imageeditor").css("display","block"))}function onSelectedCleared(){$("#texteditor").css("display","none"),$("#text-string").val(""),$("#imageeditor").css("display","none")}function setFont(e){var t=canvas.getActiveObject();t&&"text"===t.type&&(t.fontFamily=e,canvas.renderAll())}function removeWhite(){var e=canvas.getActiveObject();e&&"image"===e.type&&(e.filters[2]=new fabric.Image.filters.RemoveWhite({hreshold:100,distance:10}),e.applyFilters(canvas.renderAll.bind(canvas)))}var canvas,tshirts=new Array,a,b,line1,line2,line3,line4;$(document).ready(function(){canvas=new fabric.Canvas("tcanvas",{hoverCursor:"pointer",selection:!0,selectionBorderColor:"blue"}),canvas.on({"object:moving":function(e){e.target.opacity=.5},"object:modified":function(e){e.target.opacity=1},"object:selected":onObjectSelected,"selection:cleared":onSelectedCleared}),canvas.findTarget=function(e){return function(){var t=e.apply(this,arguments);return t?this._hoveredTarget!==t&&(canvas.fire("object:over",{target:t}),this._hoveredTarget&&canvas.fire("object:out",{target:this._hoveredTarget}),this._hoveredTarget=t):this._hoveredTarget&&(canvas.fire("object:out",{target:this._hoveredTarget}),this._hoveredTarget=null),t}}(canvas.findTarget),canvas.on("object:over",function(){}),canvas.on("object:out",function(){}),document.getElementById("add-text").onclick=function(){var e=$("#text-string").val(),t=new fabric.Text(e,{left:fabric.util.getRandomInt(0,200),top:fabric.util.getRandomInt(0,400),fontFamily:"helvetica",angle:0,fill:"#000000",scaleX:.5,scaleY:.5,fontWeight:"",hasRotatingPoint:!0});canvas.add(t),canvas.item(canvas.item.length-1).hasRotatingPoint=!0,$("#texteditor").css("display","block"),$("#imageeditor").css("display","block")},$("#text-string").keyup(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.text=this.value,canvas.renderAll())}),$("#phoneTypes").change(function(){"1"==$(this).val()?($("#phoneDiv").css("height","590"),$("#phone")[0].src="img/phones/iphone5A.png",line1=new fabric.Line([0,0,225,0],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line2=new fabric.Line([224,0,225,450],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line3=new fabric.Line([0,0,0,450],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line4=new fabric.Line([0,450,225,449],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1})):"2"==$(this).val()?($("#phoneDiv").css("height","540"),$("#phone")[0].src="img/phones/iPhone4A.png",line1=new fabric.Line([0,20,220,20],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line2=new fabric.Line([220,20,220,420],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line3=new fabric.Line([0,20,0,420],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line4=new fabric.Line([0,420,220,420],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1})):"3"==$(this).val()&&($("#phoneDiv").css("height","535"),$("#phone")[0].src="img/phones/GalaxyS3A.png",line1=new fabric.Line([0,30,225,30],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line2=new fabric.Line([224,30,225,400],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line3=new fabric.Line([0,30,0,400],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line4=new fabric.Line([0,400,225,400],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}))}),line1=new fabric.Line([0,0,225,0],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line2=new fabric.Line([224,0,225,450],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line3=new fabric.Line([0,0,0,450],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),line4=new fabric.Line([0,450,225,449],{stroke:"#000000",strokeWidth:1,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,selectable:!1}),$(".img-polaroid").click(function(e){var t=(e.target,$(this).attr("src"));$("#phoneDiv").css({backgroundImage:"url("+t+")",backgroundRepeat:"no-repeat",backgroundPosition:"top center","background-size":"100% 100%"})}),document.getElementById("remove-selected").onclick=function(){var e=canvas.getActiveObject(),t=canvas.getActiveGroup();if(e)canvas.remove(e),$("#text-string").val("");else if(t){var n=t.getObjects();canvas.discardActiveGroup(),n.forEach(function(e){canvas.remove(e)})}},document.getElementById("bring-to-front").onclick=function(){var e=canvas.getActiveObject(),t=canvas.getActiveGroup();if(e)e.bringToFront();else if(t){var n=t.getObjects();canvas.discardActiveGroup(),n.forEach(function(e){e.bringToFront()})}},document.getElementById("send-to-back").onclick=function(){var e=canvas.getActiveObject(),t=canvas.getActiveGroup();if(e)e.sendToBack();else if(t){var n=t.getObjects();canvas.discardActiveGroup(),n.forEach(function(e){e.sendToBack()})}},$("#text-bold").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.fontWeight="bold"==e.fontWeight?"":"bold",canvas.renderAll())}),$("#text-italic").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.fontStyle="italic"==e.fontStyle?"":"italic",canvas.renderAll())}),$("#text-strike").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.textDecoration="line-through"==e.textDecoration?"":"line-through",canvas.renderAll())}),$("#text-underline").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.textDecoration="underline"==e.textDecoration?"":"underline",canvas.renderAll())}),$("#text-left").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.textAlign="left",canvas.renderAll())}),$("#text-center").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.textAlign="center",canvas.renderAll())}),$("#text-right").click(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.textAlign="right",canvas.renderAll())}),$("#font-family").change(function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.fontFamily=this.value,canvas.renderAll())}),$("#text-bgcolor").miniColors({change:function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.backgroundColor=this.value,canvas.renderAll())},open:function(){},close:function(){}}),$("#text-fontcolor").miniColors({change:function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.fill=this.value,canvas.renderAll())},open:function(){},close:function(){}}),$("#text-strokecolor").miniColors({change:function(){var e=canvas.getActiveObject();e&&"text"===e.type&&(e.strokeStyle=this.value,canvas.renderAll())},open:function(){},close:function(){}}),$("#drawingArea").hover(function(){canvas.add(line1),canvas.add(line2),canvas.add(line3),canvas.add(line4),canvas.renderAll()},function(){canvas.remove(line1),canvas.remove(line2),canvas.remove(line3),canvas.remove(line4),canvas.renderAll()}),$(".color-preview").click(function(){var e=$(this).css("background-color");document.getElementById("phoneDiv").style.backgroundColor=e}),$(".clearfix button,a").tooltip()});